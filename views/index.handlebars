<h1>Burger Time!</h1>

<div class="container">
  <div class="row">
    <div class="col-4">
      <h3>Burgers that aren't devoured</h3>

      <ul>
        {{#each burgers}}
        {{#unless devoured}}
        <li>
          <p>
            {{this.id}}.{{this.burger_name}}
            <button data-burgerid="{{this.id}}" class="devourburg">Devour</button>
          </p>
        </li>
        {{/unless}}
        {{/each}}
      </ul>
    </div>
    <div class="col-4">
      <h3>Add a Burger</h3>
      <form id="addburger">

        <div class="form-group">
          <label for="burg">Burger Name:</label>
          <input type="text" id="burg" name="burger">
        </div>
        <button type="submit">Add Burger</button>
      </form>
    </div>

    <div class="col-4">
      <h3>Burgers that are devoured</h3>
      <ul>
        {{#each burgers}}
        {{#if devoured}}
        <li>
          <p>
            {{this.id}}.{{this.burger_name}}
          </p>
        </li>
        {{/if}}
        {{/each}}
      </ul>
    </div>
  </div>
</div>
<script type="text/javascript">
  $("#addburger").on("submit", function (event) {
    // Make sure to preventDefault on a submit event.
    event.preventDefault();

    var newBurger = {
      burger: $("#addburger [name=burger]").val().trim()
    };
    console.log(newBurger)
    // Send the POST request.
    $.ajax("/api/burgers", {
      type: "POST",
      data: newBurger
    }).then(
      function () {
        location.reload();
      }
    );
  });
  $(".devourburg").on("click", function (event) {
    event.preventDefault();
    var id = $(this).data("burgerid");
    console.log(id)
    var devouredBurg = {
      devoured: true
    };
    $.ajax("/api/burgers/" + id, {
      type: "PUT",
      data: devouredBurg
    }).then(
      function () {
        // Reload the page to get the updated list
        location.reload();
      }
    );
  })

</script>